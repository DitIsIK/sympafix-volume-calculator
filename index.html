<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sympafix volumecalculator</title>
  
  <script src="https://cdn.tailwindcss.com"></script>
  
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-gray-100 font-sans text-gray-800">
  <div id="root" class="min-h-screen flex items-center justify-center p-4"></div>

  <script type="text/babel">
    function SympafixCalculator() {
      const [step, setStep] = React.useState(1);
      const [inputs, setInputs] = React.useState({
        product: "_C100_PLUS",
        verlijming: "massief_draadeinden",
        staafdiameter: 16,
        boordiameter: 18,
        diepte: 440,
        verlies: 15,
        kokermaat: 300,
        aantalGaten: 36,
        zeefhuls: "",
      });
      const [result, setResult] = React.useState(null);

      const DIAMETER_OPTIES = {
        massief_draadeinden: [6, 8, 10, 12, 16, 20, 24, 27, 30],
        massief_wapening: [8, 10, 12, 14, 16, 20, 25, 28, 32],
      };

      const BOORDIAMETER_MAPPING = {
        massief_draadeinden: { 6: 8, 8: 10, 10: 12, 12: 14, 16: 18, 20: 24, 24: 28, 27: 32, 30: 35 },
        massief_wapening: { 8: 12, 10: 14, 12: 16, 14: 18, 16: 20, 20: 24, 25: 32, 28: 35, 32: 40 },
      };

      const ZEEFHULS_MAPPING = {
        "M6 - Zeefhuls 12mm": 12,
        "M8 - Zeefhuls 12mm": 12,
        "M8 - Zeefhuls 16mm": 16,
        "M10 - Zeefhuls 16mm": 16,
        "M12 - Zeefhuls 16mm": 16,
        "M12 - Zeefhuls 20mm": 20,
        "M16 - Zeefhuls 20mm": 20,
      };

      const isHolOptieToegestaan = (product) => ["_C100_PLUS", "_M50_PLUS"].includes(product);

      function getBoordiameter(verlijming, staafdiameter, zeefhuls, fallback) {
        if (verlijming === "hol_zeefhuls") {
          return zeefhuls ? (ZEEFHULS_MAPPING[zeefhuls] ?? fallback) : fallback;
        }
        const mapping = BOORDIAMETER_MAPPING[verlijming] || {};
        return mapping[staafdiameter] ?? fallback;
      }

      function computeNewStateOnProductSelect(prev, productValue) {
        const holToegestaan = isHolOptieToegestaan(productValue);
        const nieuweVerlijming = holToegestaan ? prev.verlijming : (prev.verlijming === "hol_zeefhuls" ? "massief_draadeinden" : prev.verlijming);
        let nieuweStaaf = prev.staafdiameter;
        if (nieuweVerlijming !== "hol_zeefhuls") {
          const opties = DIAMETER_OPTIES[nieuweVerlijming];
          if (!opties || !opties.includes(nieuweStaaf)) nieuweStaaf = opties[0];
        }
        const nieuweBoord = getBoordiameter(nieuweVerlijming, nieuweStaaf, prev.zeefhuls, prev.boordiameter);
        return { ...prev, product: productValue, verlijming: nieuweVerlijming, staafdiameter: nieuweStaaf, boordiameter: nieuweBoord };
      }

      const handleChange = (e) => {
        const { name, value } = e.target;
        if (name === "staafdiameter") {
          const d = parseInt(value, 10);
          const bd = getBoordiameter(inputs.verlijming, d, inputs.zeefhuls, inputs.boordiameter);
          setInputs((prev) => ({ ...prev, staafdiameter: d, boordiameter: bd }));
          return;
        }
        if (name === "verlijming") {
          const nieuweVerlijming = value;
          if (nieuweVerlijming === "hol_zeefhuls") {
            const bd = getBoordiameter("hol_zeefhuls", inputs.staafdiameter, inputs.zeefhuls, inputs.boordiameter);
            setInputs((prev) => ({ ...prev, verlijming: nieuweVerlijming, boordiameter: bd }));
            return;
          }
          const opties = DIAMETER_OPTIES[nieuweVerlijming];
          const geldige = opties.includes(inputs.staafdiameter) ? inputs.staafdiameter : opties[0];
          const bd = getBoordiameter(nieuweVerlijming, geldige, inputs.zeefhuls, inputs.boordiameter);
          setInputs((prev) => ({ ...prev, verlijming: nieuweVerlijming, staafdiameter: geldige, boordiameter: bd }));
          return;
        }
        if (name === "zeefhuls") {
          const zh = value;
          const bd = getBoordiameter("hol_zeefhuls", inputs.staafdiameter, zh, inputs.boordiameter);
          setInputs((prev) => ({ ...prev, zeefhuls: zh, boordiameter: bd }));
          return;
        }
        const numericFields = ["diepte", "verlies", "kokermaat", "aantalGaten"];
        if (numericFields.includes(name)) {
          const num = value === "" ? "" : Number(value);
          setInputs((prev) => ({ ...prev, [name]: num }));
        } else {
          setInputs((prev) => ({ ...prev, [name]: value }));
        }
      };

      const calculate = () => {
        const pi = 3.14;
        const straal = inputs.boordiameter / 20;
        const hoogte = inputs.diepte / 10;
        const verliesFactor = 1 + inputs.verlies / 100;
        let volumePerGat = 0;
        if (inputs.verlijming === "massief_draadeinden") volumePerGat = pi * straal * straal * hoogte * 0.5 * verliesFactor;
        else if (inputs.verlijming === "massief_wapening") volumePerGat = pi * straal * straal * hoogte * 0.7 * verliesFactor;
        else if (inputs.verlijming === "hol_zeefhuls") volumePerGat = pi * straal * straal * hoogte * verliesFactor;
        const totaalVolume = volumePerGat * inputs.aantalGaten;
        const nuttigeInhoud = inputs.kokermaat - 50;
        const aantalKokers = Math.ceil(totaalVolume / nuttigeInhoud);
        setResult({ volumePerGat, totaalVolume, aantalKokers });
      };

      const renderKokerOptions = () => {
        switch (inputs.product) {
          case "_UC200_PLUS_ULTRABOND": return [280, 420];
          case "_C100_PLUS": return [150, 300, 360, 420];
          case "_M50_PLUS": return [300, 410];
          case "_X150_PLUS": return [585, 1400];
          default: return [300];
        }
      };

      const renderDiameterOptions = () => {
        if (inputs.verlijming === "massief_draadeinden") {
          return DIAMETER_OPTIES.massief_draadeinden.map((d) => (
            <option key={d} value={d}>{`M${d}`}</option>
          ));
        }
        if (inputs.verlijming === "massief_wapening") {
          return DIAMETER_OPTIES.massief_wapening.map((d) => (
            <option key={d} value={d}>{`Ø${d}`}</option>
          ));
        }
        return [];
      };

      const renderZeefhulsOptions = () => (
        Object.keys(ZEEFHULS_MAPPING).map((label) => (
          <option key={label} value={label}>{label}</option>
        ))
      );

      // STAP 1: PRODUCT KIEZEN
      if (step === 1) {
        const products = [
          { label: "UC200-PLUS ULTRABOND", value: "_UC200_PLUS_ULTRABOND", img: "uc200plus.png" },
          { label: "C100-PLUS", value: "_C100_PLUS", img: "c100plus.png" },
          { label: "M50-PLUS", value: "_M50_PLUS", img: "m50plus.png" },
          { label: "X150+PLUS", value: "_X150_PLUS", img: "x150plus.png" },
        ];
        const handleProductSelect = (productValue) => {
          setInputs((prev) => computeNewStateOnProductSelect(prev, productValue));
          setStep(2);
        };
        return (
          <div className="w-full max-w-3xl bg-white shadow-xl rounded-2xl p-6">
            <h1 className="text-3xl font-bold text-center mb-8 text-gray-900">Kies uw product</h1>
            <div className="grid grid-cols-2 gap-6">
              {products.map((product) => (
                <button
                  key={product.value}
                  onClick={() => handleProductSelect(product.value)}
                  className="border-2 border-gray-100 rounded-2xl p-6 hover:border-black hover:shadow-xl transition-all duration-200 flex flex-col items-center bg-white group"
                >
                  <span className="font-bold mb-4 text-center text-lg text-gray-800 group-hover:text-black">{product.label}</span>
                  {/* Hier zorgen className 'h-32' en 'object-contain' ervoor dat het plaatje nooit te groot wordt */}
                  <img 
                    src={`${product.img}`} 
                    alt={product.label} 
                    className="h-32 w-auto object-contain rounded-md" 
                  />
                </button>
              ))}
            </div>
          </div>
        );
      }

      // STAP 2: DE REKENMACHINE
      return (
        <div className="w-full max-w-lg bg-white shadow-xl rounded-2xl p-6 space-y-6">
          <button onClick={() => setStep(1)} className="text-sm font-medium text-gray-500 hover:text-black flex items-center transition">
            ← Terug naar productkeuze
          </button>
          
          <div>
            <h1 className="text-2xl font-extrabold text-center text-gray-900">Volumecalculator</h1>
            <p className="text-center text-sm text-green-600 font-medium mt-1">
              {inputs.product.replace(/_/g, ' ').trim()}
            </p>
          </div>

          <div className="grid grid-cols-1 gap-4 bg-gray-50 p-4 rounded-xl border border-gray-100">
            
            {/* Invoer velden grid */}
            <div className="grid grid-cols-2 gap-4 items-center">
              <label className="font-semibold text-sm text-gray-700">Volume koker:</label>
              <select name="kokermaat" value={inputs.kokermaat} onChange={handleChange} className="p-2 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-black outline-none">
                {renderKokerOptions().map((ml) => (<option key={ml} value={ml}>{ml} ml</option>))}
              </select>

              <label className="font-semibold text-sm text-gray-700">Toepassing:</label>
              <select name="verlijming" value={inputs.verlijming} onChange={handleChange} className="p-2 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-black outline-none">
                <option value="massief_draadeinden">Massief beton (draadeind)</option>
                <option value="massief_wapening">Massief beton (wapening)</option>
                {isHolOptieToegestaan(inputs.product) && (<option value="hol_zeefhuls">Hol metselwerk (zeefhuls)</option>)}
              </select>

              {inputs.verlijming === "hol_zeefhuls" ? (
                <>
                  <label className="font-semibold text-sm text-gray-700">Zeefhuls:</label>
                  <select name="zeefhuls" value={inputs.zeefhuls} onChange={handleChange} className="p-2 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-black outline-none">
                    {renderZeefhulsOptions()}
                  </select>
                </>
              ) : (
                <>
                  <label className="font-semibold text-sm text-gray-700">Diameter anker:</label>
                  <select name="staafdiameter" value={inputs.staafdiameter} onChange={handleChange} className="p-2 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-black outline-none">
                    {renderDiameterOptions()}
                  </select>
                </>
              )}

              <label className="font-semibold text-sm text-gray-700">Boordiameter:</label>
              <div className="p-2 rounded-lg bg-gray-200 text-gray-700 font-mono text-center">{inputs.boordiameter} mm</div>

              <label className="font-semibold text-sm text-gray-700">Boordiepte (mm):</label>
              <input type="number" name="diepte" value={inputs.diepte} onChange={handleChange} className="p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black outline-none" />

              <label className="font-semibold text-sm text-gray-700">Verlies:</label>
              <select name="verlies" value={inputs.verlies} onChange={handleChange} className="p-2 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-black outline-none">
                <option value={10}>10%</option>
                <option value={15}>15%</option>
                <option value={20}>20%</option>
                <option value={25}>25%</option>
              </select>

              <label className="font-semibold text-sm text-gray-700">Aantal gaten:</label>
              <input type="number" name="aantalGaten" value={inputs.aantalGaten} onChange={handleChange} className="p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black outline-none" />
            </div>
          </div>

          <button onClick={calculate} className="w-full bg-black text-white font-bold text-lg px-6 py-3 rounded-xl hover:bg-gray-800 transform active:scale-95 transition shadow-lg">
            Bereken nu
          </button>

          {result && (
            <div className="animate-fade-in mt-6 p-5 border-l-4 border-black bg-gray-50 rounded-r-xl shadow-inner">
              <div className="flex justify-between items-center mb-2">
                <span className="text-gray-600">Volume per gat:</span>
                <span className="font-bold">{result.volumePerGat.toFixed(1)} ml</span>
              </div>
              <div className="flex justify-between items-center mb-2">
                <span className="text-gray-600">Totaal volume:</span>
                <span className="font-bold">{result.totaalVolume.toFixed(1)} ml</span>
              </div>
              <div className="border-t border-gray-300 my-2 pt-2 flex justify-between items-center text-lg">
                <span className="font-bold text-black">Benodigde kokers:</span>
                <span className="font-black text-white bg-black px-3 py-1 rounded-lg">{result.aantalKokers}</span>
              </div>
            </div>
          )}

          <p className="text-xs text-gray-400 text-center pt-4 border-t italic">
            Disclaimer: Aan het gebruik van deze tool kunnen geen rechten worden ontleend. Controleer altijd zelf of de informatie juist is.
          </p>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<SympafixCalculator />);
  </script>
</body>
</html>
